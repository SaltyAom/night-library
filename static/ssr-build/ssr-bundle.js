module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s="/hs+")}({"/SXw":function(e,t,n){},"/hs+":function(e,t,n){"use strict";n.r(t);var r,o,i,c=n("HteQ"),a=0,u=[],s=c.options.__r,l=c.options.diffed,f=c.options.__c,h=c.options.unmount;function d(e,t){c.options.__h&&c.options.__h(o,e,a||t),a=0;var n=o.__H||(o.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function p(e){return a=1,v(E,e)}function v(e,t,n){var i=d(r++,2);return i.t=e,i.__c||(i.__c=o,i.__=[n?n(t):E(void 0,t),function(e){var t=i.t(i.__[0],e);i.__[0]!==t&&(i.__=[t,i.__[1]],i.__c.setState({}))}]),i.__}function b(e,t){var n=d(r++,3);!c.options.__s&&S(n.__H,t)&&(n.__=e,n.__H=t,o.__H.__h.push(n))}function _(e,t){var n=d(r++,4);!c.options.__s&&S(n.__H,t)&&(n.__=e,n.__H=t,o.__h.push(n))}function m(e){return a=5,y((function(){return{current:e}}),[])}function y(e,t){var n=d(r++,7);return S(n.__H,t)?(n.__H=t,n.__h=e,n.__=e()):n.__}function O(e,t){return a=8,y((function(){return e}),t)}function g(e){var t=o.context[e.__c],n=d(r++,9);return n.__c=e,t?(null==n.__&&(n.__=!0,t.sub(o)),t.props.value):e.__}function j(){u.some((function(e){if(e.__P)try{e.__H.__h.forEach(k),e.__H.__h.forEach(P),e.__H.__h=[]}catch(t){return e.__H.__h=[],c.options.__e(t,e.__v),!0}})),u=[]}c.options.__r=function(e){s&&s(e),r=0;var t=(o=e.__c).__H;t&&(t.__h.forEach(k),t.__h.forEach(P),t.__h=[])},c.options.diffed=function(e){l&&l(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==u.push(t)&&i===c.options.requestAnimationFrame||((i=c.options.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),w&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);w&&(t=requestAnimationFrame(n))})(j))},c.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(k),e.__h=e.__h.filter((function(e){return!e.__||P(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],c.options.__e(n,e.__v)}})),f&&f(e,t)},c.options.unmount=function(e){h&&h(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(k)}catch(e){c.options.__e(e,t.__v)}};var w="function"==typeof requestAnimationFrame;function k(e){"function"==typeof e.u&&e.u()}function P(e){e.u=e.__()}function S(e,t){return!e||t.some((function(t,n){return t!==e[n]}))}function E(e,t){return"function"==typeof t?t(e):t}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A,U,L,R=function(e){e.on("@init",(function(){return{username:null,initial:!0}})),e.on("UPDATE_USERNAME",(function(e,t){return{username:t,initial:!1}})),e.on("LOGOUT",(function(e){return{username:null,initial:!1}}))},H=(A={},U={},L={dispatch:function(e,t){if("@dispatch"!==e&&L.dispatch("@dispatch",[e,t,A[e]]),A[e]){var n,r={};A[e].forEach((function(e){var o=e(U,t);o&&"function"!=typeof o.then&&(n=U=x(x({},U),o),r=x(x({},r),o))})),n&&L.dispatch("@changed",r)}},get:function(){return U},on:function(e,t){return(A[e]||(A[e]=[])).push(t),function(){A[e]=A[e].filter((function(e){return e!==t}))}}},[R].forEach((function(e){e&&e(L)})),L.dispatch("@init"),L);function D(e,t){for(var n in t)e[n]=t[n];return e}function M(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}var N=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).isPureReactComponent=!0,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r.prototype.shouldComponentUpdate=function(e,t){return M(this.props,e)||M(this.state,t)},r}(c.Component);var F=c.options.__b;c.options.__b=function(e){e.type&&e.type.t&&e.ref&&(e.props.ref=e.ref,e.ref=null),F&&F(e)};var B="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function I(e){function t(t,n){var r=D({},t);return delete r.ref,e(r,(n=t.ref||n)&&("object"!=typeof n||"current"in n)?n:null)}return t.$$typeof=B,t.render=t,t.prototype.isReactComponent=t.t=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var W=function(e,t){return e?Object(c.toChildArray)(e).reduce((function(e,n,r){return e.concat(t(n,r))}),[]):null},V={map:W,forEach:W,count:function(e){return e?Object(c.toChildArray)(e).length:0},only:function(e){if(1!==(e=Object(c.toChildArray)(e)).length)throw new Error("Children.only() expects only one child.");return e[0]},toArray:c.toChildArray},q=c.options.__e;function K(e){return e&&((e=D({},e)).__c=null,e.__k=e.__k&&e.__k.map(K)),e}function z(){this.__u=0,this.o=null,this.__b=null}function $(e){var t=e.__.__c;return t&&t.u&&t.u(e)}function Q(){this.i=null,this.l=null}c.options.__e=function(e,t,n){if(e.then)for(var r,o=t;o=o.__;)if((r=o.__c)&&r.__c)return r.__c(e,t.__c);q(e,t,n)},(z.prototype=new c.Component).__c=function(e,t){var n=this;null==n.o&&(n.o=[]),n.o.push(t);var r=$(n.__v),o=!1,i=function(){o||(o=!0,r?r(c):c())};t.__c=t.componentWillUnmount,t.componentWillUnmount=function(){i(),t.__c&&t.__c()};var c=function(){var e;if(!--n.__u)for(n.__v.__k[0]=n.state.u,n.setState({u:n.__b=null});e=n.o.pop();)e.forceUpdate()};n.__u++||n.setState({u:n.__b=n.__v.__k[0]}),e.then(i,i)},z.prototype.render=function(e,t){return this.__b&&(this.__v.__k&&(this.__v.__k[0]=K(this.__b)),this.__b=null),[Object(c.createElement)(c.Fragment,null,t.u?null:e.children),t.u&&e.fallback]};var G=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};(Q.prototype=new c.Component).u=function(e){var t=this,n=$(t.__v),r=t.l.get(e);return r[0]++,function(o){var i=function(){t.props.revealOrder?(r.push(o),G(t,e,r)):o()};n?n(i):i()}},Q.prototype.render=function(e){this.i=null,this.l=new Map;var t=Object(c.toChildArray)(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},Q.prototype.componentDidUpdate=Q.prototype.componentDidMount=function(){var e=this;e.l.forEach((function(t,n){G(e,n,t)}))};var J=function(){function e(){}var t=e.prototype;return t.getChildContext=function(){return this.props.context},t.render=function(e){return e.children},e}();function Z(e){var t=this,n=e.container,r=Object(c.createElement)(J,{context:t.context},e.vnode);return t.s&&t.s!==n&&(t.v.parentNode&&t.s.removeChild(t.v),Object(c.__u)(t.h),t.p=!1),e.vnode?t.p?(n.__k=t.__k,Object(c.render)(r,n),t.__k=n.__k):(t.v=document.createTextNode(""),Object(c.hydrate)("",n),n.appendChild(t.v),t.p=!0,t.s=n,Object(c.render)(r,n,t.v),t.__k=t.v.__k):t.p&&(t.v.parentNode&&t.s.removeChild(t.v),Object(c.__u)(t.h)),t.h=r,t.componentWillUnmount=function(){t.v.parentNode&&t.s.removeChild(t.v),Object(c.__u)(t.h)},null}var X=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;c.Component.prototype.isReactComponent={};var Y="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;var ee=c.options.event;function te(e,t){e["UNSAFE_"+t]&&!e[t]&&Object.defineProperty(e,t,{configurable:!1,get:function(){return this["UNSAFE_"+t]},set:function(e){this["UNSAFE_"+t]=e}})}c.options.event=function(e){ee&&(e=ee(e)),e.persist=function(){};var t=!1,n=!1,r=e.stopPropagation;e.stopPropagation=function(){r.call(e),t=!0};var o=e.preventDefault;return e.preventDefault=function(){o.call(e),n=!0},e.isPropagationStopped=function(){return t},e.isDefaultPrevented=function(){return n},e.nativeEvent=e};var ne={configurable:!0,get:function(){return this.class}},re=c.options.vnode;c.options.vnode=function(e){e.$$typeof=Y;var t=e.type,n=e.props;if(t){if(n.class!=n.className&&(ne.enumerable="className"in n,null!=n.className&&(n.class=n.className),Object.defineProperty(n,"className",ne)),"function"!=typeof t){var r,o,i;for(i in n.defaultValue&&void 0!==n.value&&(n.value||0===n.value||(n.value=n.defaultValue),delete n.defaultValue),Array.isArray(n.value)&&n.multiple&&"select"===t&&(Object(c.toChildArray)(n.children).forEach((function(e){-1!=n.value.indexOf(e.props.value)&&(e.props.selected=!0)})),delete n.value),n)if(r=X.test(i))break;if(r)for(i in o=e.props={},n)o[X.test(i)?i.replace(/[A-Z0-9]/,"-$&").toLowerCase():i]=n[i]}!function(t){var n=e.type,r=e.props;if(r&&"string"==typeof n){var o={};for(var i in r)/^on(Ani|Tra|Tou)/.test(i)&&(r[i.toLowerCase()]=r[i],delete r[i]),o[i.toLowerCase()]=i;if(o.ondoubleclick&&(r.ondblclick=r[o.ondoubleclick],delete r[o.ondoubleclick]),o.onbeforeinput&&(r.onbeforeinput=r[o.onbeforeinput],delete r[o.onbeforeinput]),o.onchange&&("textarea"===n||"input"===n.toLowerCase()&&!/^fil|che|ra/i.test(r.type))){var c=o.oninput||"oninput";r[c]||(r[c]=r[o.onchange],delete r[o.onchange])}}}(),"function"==typeof t&&!t.m&&t.prototype&&(te(t.prototype,"componentWillMount"),te(t.prototype,"componentWillReceiveProps"),te(t.prototype,"componentWillUpdate"),t.m=!0)}re&&re(e)};function oe(e){return!!e&&e.$$typeof===Y}c.Fragment,c.createElement,c.createContext,c.createRef,c.Fragment,c.Component,c.Fragment;var ie,ce=Object(c.createContext)(),ae="undefined"!=typeof window?_:b,ue=(ie=ce,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=g(ie),o=p({});return ae((function(){return r.on("@changed",(function(e,n){t.some((function(e){return e in n}))&&o[1]({})}))}),[]),y((function(){var e=r.get(),n={};return t.forEach((function(t){n[t]=e[t]})),n.dispatch=r.dispatch,n}),[o[0]])}),se=function(e){var t=(void 0===e?{}:e).base,n=void 0===t?"":t,r=p(he(n)),o=r[0],i=r[1],c=m(o);return b((function(){fe();var e=function(){var e=he(n);c.current!==e&&i(c.current=e)},t=["popstate","pushState","replaceState"];return t.map((function(t){return addEventListener(t,e)})),e(),function(){return t.map((function(t){return removeEventListener(t,e)}))}}),[n]),[o,O((function(e,t){var r=(void 0===t?{}:t).replace;return history[void 0!==r&&r?"replaceState":"pushState"](0,0,n+e)}),[n])]},le=0,fe=function(){if(!le)return["pushState","replaceState"].map((function(e){var t=history[e];history[e]=function(){var n=t.apply(this,arguments),r=new Event(e);return r.arguments=arguments,dispatchEvent(r),n}})),le=1},he=function(e,t){return void 0===t&&(t=location.pathname),t.indexOf(e)?t:t.slice(e.length)||"/"};function de(e){void 0===e&&(e=be);var t={};return function(n,r){var o=function(n){return t[n]||(t[n]=e(n))}(n||""),i=o.regexp,c=o.keys,a=i.exec(r);return a?[!0,c.reduce((function(e,t,n){return e[t.name]=a[n+1],e}),{})]:[!1,null]}}var pe=function(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")},ve=function(e,t,n){var r=e?"((?:[^\\/]+?)(?:\\/(?:[^\\/]+?))*)":"([^\\/]+?)";return t&&n&&(r="(?:\\/"+r+")"),r+(t?"?":"")},be=function(e){for(var t=/:([A-Za-z0-9_]+)([?+*]?)/g,n=null,r=0,o=[],i="";null!==(n=t.exec(e));){var c=n,a=(c[0],c[1]),u=c[2],s="+"===u||"*"===u,l="?"===u||"*"===u,f=l&&"/"===e[n.index-1]?1:0,h=e.substring(r,n.index-f);o.push({name:a}),r=t.lastIndex,i+=pe(h)+ve(s,l,f)}return i+=pe(e.substring(r)),{keys:o,regexp:new RegExp("^"+i+"(?:\\/)?$","i")}};var _e=Object(c.createContext)({}),me=function(e){var t=void 0===e?{}:e,n=t.hook,r=void 0===n?se:n,o=t.base,i=void 0===o?"":o,c=t.matcher;return{hook:r,base:i,matcher:void 0===c?de():c}},ye=function(){var e=g(_e);return e.v||(e.v=me())},Oe=function(){var e=ye();return e.hook(e)},ge=function(e){var t=m(),n=Oe()[1];return t.current=function(){return n(e.to||e.href,e)},t},je=function(e){var t=ge(e),n=ye().base,r=e.to,o=e.href,i=void 0===o?r:o,a=e.children,u=e.onClick,s={href:n+i,onClick:O((function(e){e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||0!==e.button||(e.preventDefault(),t.current(),u&&u(e))}),[u]),to:null},l=Object(c.isValidElement)(a)?a:Object(c.createElement)("a",e);return Object(c.cloneElement)(l,s)},we=function(e){var t=ge(e);return _((function(){return t.current()}),[]),null},ke=(n("hVea"),function(e){var t=e.children,n=e.href;return Object(c.h)(je,{href:n},Object(c.h)("a",{class:"action"},Object(c.h)("p",{class:"name"},t),Object(c.h)("div",{class:"line"})))}),Pe=(n("8Ubq"),function(){var e=ue("username").username;return Object(c.h)("nav",{id:"navigator"},Object(c.h)("section",{class:"header"},Object(c.h)(je,{href:"/"},Object(c.h)("a",{class:"title"},Object(c.h)("h1",{class:"value"},"Night Library")))),Object(c.h)("section",{id:"action-list"},e?Object(c.h)(c.Fragment,null,Object(c.h)(ke,{href:"/my-book"},"My Book"),Object(c.h)(ke,{href:"/me"},e)):Object(c.h)(c.Fragment,null,Object(c.h)(ke,{href:"/signin"},"Signin"),Object(c.h)(ke,{href:"/signup"},"Signup"))))}),Se=(n("/SXw"),function(e){var t=e.children;return Object(c.h)(c.Fragment,null,Object(c.h)(Pe,null),Object(c.h)("main",{id:"main"},t))}),Ee=function(e){var t=e.children,n=ue().dispatch;return b((function(){fetch("http://localhost/api/refresh?time="+Date.now(),{method:"POST",credentials:"include"}).then((function(e){return e.text()})).then((function(e){e?n("UPDATE_USERNAME",e):n("LOGOUT","")}))}),[]),t},Ce=0,xe=function(){if(!Ce)return["pushState","replaceState"].map((function(e){var t=history[e];history[e]=function(){var n=t.apply(this,arguments),r=new Event(e);return r.arguments=arguments,dispatchEvent(r),n}})),Ce=1},Te=function(e,t){return void 0===t&&(t=location.pathname),t.indexOf(e)?t:t.slice(e.length)||"/"},Ae=n("OoM2"),Ue=n.n(Ae);function Le(){return"undefined"==typeof document||void 0===document.visibilityState||"hidden"!==document.visibilityState}function Re(){return void 0===navigator.onLine||navigator.onLine}var He=new WeakMap,De=0;var Me=new(function(){function e(e){void 0===e&&(e={}),this.__cache=new Map(Object.entries(e)),this.__listeners=[]}return e.prototype.get=function(e){var t=this.serializeKey(e)[0];return this.__cache.get(t)},e.prototype.set=function(e,t,n){void 0===n&&(n=!0);var r=this.serializeKey(e)[0];this.__cache.set(r,t),n&&ot(e,t,!1),this.notify()},e.prototype.keys=function(){return Array.from(this.__cache.keys())},e.prototype.has=function(e){var t=this.serializeKey(e)[0];return this.__cache.has(t)},e.prototype.clear=function(e){void 0===e&&(e=!0),e&&this.__cache.forEach((function(e){return ot(e,null,!1)})),this.__cache.clear(),this.notify()},e.prototype.delete=function(e,t){void 0===t&&(t=!0);var n=this.serializeKey(e)[0];t&&ot(e,null,!1),this.__cache.delete(n),this.notify()},e.prototype.serializeKey=function(e){var t=null;if("function"==typeof e)try{e=e()}catch(t){e=""}return Array.isArray(e)?(t=e,e=function(e){if(!e.length)return"";for(var t="arg",n=0;n<e.length;++n){var r=void 0;null===e[n]||"object"!=typeof e[n]?r="string"==typeof e[n]?'"'+e[n]+'"':String(e[n]):He.has(e[n])?r=He.get(e[n]):(r=De,He.set(e[n],De++)),t+="@"+r}return t}(e)):e=String(e||""),[e,t,e?"err@"+e:""]},e.prototype.subscribe=function(e){var t=this;if("function"!=typeof e)throw new Error("Expected the listener to be a function.");var n=!0;return this.__listeners.push(e),function(){if(n){n=!1;var r=t.__listeners.indexOf(e);r>-1&&(t.__listeners[r]=t.__listeners[t.__listeners.length-1],t.__listeners.length--)}}},e.prototype.notify=function(){for(var e=0,t=this.__listeners;e<t.length;e++){(0,t[e])()}},e}()),Ne={},Fe={},Be={},Ie={},We={};var Ve="undefined"!=typeof window&&navigator.connection&&-1!==["slow-2g","2g"].indexOf(navigator.connection.effectiveType),qe={onLoadingSlow:function(){},onSuccess:function(){},onError:function(){},onErrorRetry:function(e,t,n,r,o){if(Le()&&!(n.errorRetryCount&&o.retryCount>n.errorRetryCount)){var i=Math.min(o.retryCount||0,8),c=~~((Math.random()+.5)*(1<<i))*n.errorRetryInterval;setTimeout(r,c,o)}},errorRetryInterval:1e3*(Ve?10:5),focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:1e3*(Ve?5:3),refreshInterval:0,revalidateOnFocus:!0,revalidateOnReconnect:!0,refreshWhenHidden:!1,refreshWhenOffline:!1,shouldRetryOnError:!0,suspense:!1,compare:Ue.a},Ke=!1;if("undefined"!=typeof window&&window.addEventListener&&!Ke){var ze=function(){if(Le()&&Re())for(var e in Be)Be[e][0]&&Be[e][0]()};window.addEventListener("visibilitychange",ze,!1),window.addEventListener("focus",ze,!1),Ke=!0}var $e=qe;function Qe(e,t){var n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];n||(n=!0,e.apply(void 0,r),setTimeout((function(){return n=!1}),t))}}var Ge=Object(c.createContext)({});Ge.displayName="SWRConfigContext";var Je=Ge;function Ze(){return(Ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Xe=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}u((r=r.apply(e,t||[])).next())}))},Ye=function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},et="undefined"==typeof window,tt=et?b:_,nt=function(e,t){void 0===t&&(t=!0);var n=Me.serializeKey(e),r=n[0],o=n[2];if(!r)return Promise.resolve();var i=Ie[r];if(r&&i){for(var c=Me.get(r),a=Me.get(o),u=[],s=0;s<i.length;++s)u.push(i[s](t,c,a,s>0));return Promise.all(u).then((function(){return Me.get(r)}))}return Promise.resolve(Me.get(r))},rt=function(e,t,n){var r=Ie[e];if(e&&r)for(var o=0;o<r.length;++o)r[o](!1,t,n)},ot=function(e,t,n){return void 0===n&&(n=!0),Xe(void 0,void 0,void 0,(function(){var r,o,i,c,a,u,s,l,f,h;return Ye(this,(function(d){switch(d.label){case 0:if(!(r=Me.serializeKey(e)[0]))return[2];if(void 0===t)return[2,nt(e,n)];if(We[r]=Date.now()-1,c=We[r],a=Fe[r],!t||"function"!=typeof t)return[3,5];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,t(Me.get(r))];case 2:return o=d.sent(),[3,4];case 3:return u=d.sent(),i=u,[3,4];case 4:return[3,11];case 5:if(!t||"function"!=typeof t.then)return[3,10];d.label=6;case 6:return d.trys.push([6,8,,9]),[4,t];case 7:return o=d.sent(),[3,9];case 8:return s=d.sent(),i=s,[3,9];case 9:return[3,11];case 10:o=t,d.label=11;case 11:if(c!==We[r]||a!==Fe[r]){if(i)throw i;return[2,o]}if(void 0!==o&&Me.set(r,o,!1),l=Ie[r]){for(f=[],h=0;h<l.length;++h)f.push(l[h](!!n,o,i,h>0));return[2,Promise.all(f).then((function(){return Me.get(r)}))]}if(i)throw i;return[2,o]}}))}))};Je.Provider;var it=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r,o,i={};t.length>=1&&(r=t[0]),t.length>2?(o=t[1],i=t[2]):"function"==typeof t[1]?o=t[1]:"object"==typeof t[1]&&(i=t[1]);var c=Me.serializeKey(r),a=c[0],u=c[1],s=c[2];i=Ze({},$e,g(Je),i),void 0===o&&(o=i.fetcher);var l=Me.get(a)||i.initialData,f=Me.get(s),h=m({data:!1,error:!1,isValidating:!1}),d=m({data:l,error:f,isValidating:!1}),v=p(null)[1],b=O((function(e){var t=!1;for(var n in e)d.current[n]=e[n],h.current[n]&&(t=!0);(t||i.suspense)&&v({})}),[]),_=m(!1),j=m(a),w=m({emit:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];_.current||i[e].apply(i,t)}}),k=O((function(e,t){return ot(a,e,t)}),[a]),P=O((function(t){return void 0===t&&(t={}),Xe(e,void 0,void 0,(function(){var e,n,r,c,l,f,h;return Ye(this,(function(p){switch(p.label){case 0:if(!a||!o)return[2,!1];if(_.current)return[2,!1];t=Ze({dedupe:!1},t),e=!0,n=void 0!==Ne[a]&&t.dedupe,p.label=1;case 1:return p.trys.push([1,6,,7]),b({isValidating:!0}),r=void 0,c=void 0,n?(c=Fe[a],[4,Ne[a]]):[3,3];case 2:return r=p.sent(),[3,5];case 3:return Ne[a]&&(We[a]=Date.now()-1),i.loadingTimeout&&!Me.get(a)&&setTimeout((function(){e&&w.current.emit("onLoadingSlow",a,i)}),i.loadingTimeout),Ne[a]=null!==u?o.apply(void 0,u):o(a),Fe[a]=c=Date.now(),[4,Ne[a]];case 4:r=p.sent(),setTimeout((function(){delete Ne[a],delete Fe[a]}),i.dedupingInterval),w.current.emit("onSuccess",r,a,i),p.label=5;case 5:return We[a]&&c<=We[a]?(b({isValidating:!1}),[2,!1]):(Me.set(a,r,!1),Me.set(s,void 0,!1),l={isValidating:!1},void 0!==d.current.error&&(l.error=void 0),i.compare(d.current.data,r)||(l.data=r),b(l),n||rt(a,r,void 0),[3,7]);case 6:return f=p.sent(),delete Ne[a],delete Fe[a],Me.set(s,f,!1),d.current.error!==f&&(b({isValidating:!1,error:f}),n||rt(a,void 0,f)),w.current.emit("onError",f,a,i),i.shouldRetryOnError&&(h=(t.retryCount||0)+1,w.current.emit("onErrorRetry",f,a,i,P,Ze({dedupe:!0},t,{retryCount:h}))),[3,7];case 7:return e=!1,[2,!0]}}))}))}),[a]);if(tt((function(){if(a){_.current=!1;var e=d.current.data,t=Me.get(a)||i.initialData;j.current===a&&i.compare(e,t)||(b({data:t}),j.current=a);var n,r=function(){return P({dedupe:!0})};(i.revalidateOnMount||!i.initialData&&void 0===i.revalidateOnMount)&&(void 0!==t&&!et&&window.requestIdleCallback?window.requestIdleCallback(r):r()),i.revalidateOnFocus&&(n=Qe(r,i.focusThrottleInterval),Be[a]?Be[a].push(n):Be[a]=[n]);var o=function(e,t,n,o){void 0===e&&(e=!0),void 0===o&&(o=!0);var c={},a=!1;return void 0===t||i.compare(d.current.data,t)||(c.data=t,a=!0),d.current.error!==n&&(c.error=n,a=!0),a&&b(c),!!e&&(o?r():P())};Ie[a]?Ie[a].push(o):Ie[a]=[o];var c=null;return!et&&window.addEventListener&&i.revalidateOnReconnect&&window.addEventListener("online",c=r),function(){var e,t;(b=function(){return null},_.current=!0,n&&Be[a])&&((t=(e=Be[a]).indexOf(n))>=0&&(e[t]=e[e.length-1],e.pop()));Ie[a]&&((t=(e=Ie[a]).indexOf(o))>=0&&(e[t]=e[e.length-1],e.pop()));!et&&window.removeEventListener&&null!==c&&window.removeEventListener("online",c)}}}),[a,P]),tt((function(){var t=null;return i.refreshInterval&&(t=setTimeout((function n(){return Xe(e,void 0,void 0,(function(){return Ye(this,(function(e){switch(e.label){case 0:return d.current.error||!i.refreshWhenHidden&&!Le()||!i.refreshWhenOffline&&!Re()?[3,2]:[4,P({dedupe:!0})];case 1:e.sent(),e.label=2;case 2:return i.refreshInterval&&(t=setTimeout(n,i.refreshInterval)),[2]}}))}))}),i.refreshInterval)),function(){t&&clearTimeout(t)}}),[i.refreshInterval,i.refreshWhenHidden,i.refreshWhenOffline,P]),i.suspense){var S=Me.get(a)||l,E=Me.get(s)||f;if(void 0===S&&void 0===E){if(Ne[a]||P(),Ne[a]&&"function"==typeof Ne[a].then)throw Ne[a];S=Ne[a]}if(void 0===S&&E)throw E;return{error:E,data:S,revalidate:P,mutate:k,isValidating:d.current.isValidating}}return y((function(){var e={revalidate:P,mutate:k};return Object.defineProperties(e,{error:{get:function(){return h.current.error=!0,j.current===a?d.current.error:f},enumerable:!0},data:{get:function(){return h.current.data=!0,j.current===a?d.current.data:l},enumerable:!0},isValidating:{get:function(){return h.current.isValidating=!0,d.current.isValidating},enumerable:!0}}),e}),[P])};new Map;var ct=it,at=function(e,t){return new Promise((function(n,r){var o,i;return"undefined"==typeof window?n([]):Promise.resolve(fetch("http://localhost/graphql",{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify({query:t})})).then((function(t){try{return o=t,Promise.resolve(o.json()).then((function(t){try{return i=t.data,n(i[e])}catch(e){return r(e)}}),r)}catch(e){return r(e)}}),r)}))},ut=function(e,t){return new Promise((function(n,r){var o;return"undefined"==typeof window?n([]):Promise.resolve(at(e,t)).then((function(e){try{return o=e.data,n(o)}catch(e){return r(e)}}),r)}))},st=(n("kJJ7"),function(e){var t=e.book,n=e.preload,r=void 0!==n&&n,o=e.hiddenPrice,i=void 0!==o&&o,a=e.onClick,u=void 0===a?function(){return null}:a,s=e.action,l=void 0===s?"Borrow":s,f=e.style,h=void 0===f?{}:f,d=e.disabled,p=void 0!==d&&d;if(r)return Object(c.h)("article",{class:"book -preload"},Object(c.h)("section",{class:"content"},Object(c.h)("h1",{class:"title"}),Object(c.h)("p",{class:"author"}),i||Object(c.h)("p",{class:"price"})),Object(c.h)("button",{class:"lend",disabled:!0}));var v=t,b=v.id,_=v.title,m=v.author,y=v.price;return Object(c.h)("article",{class:"book "+b,style:h},Object(c.h)("section",{class:"content"},Object(c.h)("h1",{class:"title"},_),Object(c.h)("p",{class:"author"},m),i||Object(c.h)("p",{class:"price"},y)),Object(c.h)("button",{class:"lend "+(p?"-disabled":""),onClick:function(){return u(b)},disabled:p},l))});n("tyAA");function lt(){return(lt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var ft=function(){var e=ue("username").username,t=p([]),n=t[0],r=t[1];if(!e)return Object(c.h)("section",{id:"book-list",class:"-error"},Object(c.h)("h3",{class:"title"},"Night Library"),Object(c.h)("p",{class:"detail"},"Online library management system written in Actix Web."),Object(c.h)(je,{href:"/signin"},Object(c.h)("a",{class:"action"},"Signin")));var o=ct(["listBook","{\n              listBook {\n                data {\n                  id,\n                  title,\n                  author,\n                  price\n                }\n              }\n            }"],ut),i=o.data,a=o.error,u=ct(["listBorrowed","{\n              listBorrowed {\n                data {\n                  id\n                }\n              }\n            }"],ut),s=u.data,l=u.error;if(a||l)return Object(c.h)("section",{id:"book-list",class:"-error"},Object(c.h)("h3",{class:"title"},"Failed to fetch"),Object(c.h)("p",{class:"detail"},"There is a problem requesting an list of books."),Object(c.h)("button",{class:"action",onClick:function(){return window.location.reload()}},"Retry"));if(!i||!s)return Object(c.h)("section",{id:"book-list"},Object(c.h)("h1",{class:"header"},"Book List"),Array(8).fill(null).map((function(e,t){return Object(c.h)(st,{key:t,preload:!0})})));var f=s.map((function(e){return e.id})),h=function(e){return new Promise((function(t,n){var o,i;return Promise.resolve(at("borrowBooks",'mutation {\n              borrowBooks(books: ["'+e+'"]) {\n                data\n                success\n              }\n            }')).then((function(e){try{return i=(o=e).data,o.success?(r(i),t()):t(console.log("Something went wrong"))}catch(e){return n(e)}}),n)}))};return Object(c.h)("section",{id:"book-list"},Object(c.h)("h1",{class:"header"},"Book List"),i.map((function(e){var t=!(!f.length&&!n.length)&&(f.includes(e.id)||n.includes(e.id));return Object(c.h)(st,lt({key:e.id},{book:e},{style:t?{opacity:.5}:{},action:t?"Borrowed":"Borrow",onClick:h,disabled:t}))})))},ht=(n("HWfQ"),function(){var e=p(""),t=e[0],n=e[1],r=v((function(e){return!0}),!1),o=r[0],i=r[1],a=m(""),u=m(""),s=ue().dispatch;b((function(){fetch("http://localhost/api/refresh",{method:"POST",credentials:"include"}).then((function(e){return e.text()})).then((function(e){e&&i(1)}))}),[]);var l=O((function(e){a.current=e.currentTarget.value}),[]),f=O((function(e){u.current=e.currentTarget.value}),[]),h=O((function(e){return new Promise((function(t,r){var o;return e.preventDefault(),a.current&&u.current?Promise.resolve(fetch("http://localhost/login",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},credentials:"include",body:new URLSearchParams({username:a.current,password:u.current})}).then((function(e){return e.json()}))).then((function(e){try{return(o=e).success||"Already signin in"===o.info?(s("UPDATE_USERNAME",a.current),i(1)):n(o.info),t()}catch(e){return r(e)}}),r):t(n("Username and Password can't be blank"))}))}),[]);return Object(c.h)("form",{id:"login",action:"http://localhost/login",method:"POST",onSubmit:h},Object(c.h)("h1",{class:"title"},"Signin"),Object(c.h)("label",{class:"label",for:"username"},"Username"),Object(c.h)("input",{class:"input username",name:"username",type:"text",placeholder:"Username",onInput:l}),Object(c.h)("label",{class:"label",for:"password"},"Password"),Object(c.h)("input",{class:"input password",name:"password",type:"password",placeholder:"Password",onChange:f}),t&&Object(c.h)("p",{class:"warning -hidden"},t),Object(c.h)("section",{class:"action"},Object(c.h)("button",{class:"login"},"Signin"),Object(c.h)(je,{href:"/signup"},Object(c.h)("a",{class:"link"},"Signup"))),o&&Object(c.h)(we,{href:"/"}))}),dt=function(){var e=p(""),t=e[0],n=e[1],r=v((function(e){return!0}),!1),o=r[0],i=r[1],a=m(""),u=m(""),s=m("");b((function(){fetch("http://localhost/api/refresh",{method:"POST",credentials:"include"}).then((function(e){return e.text()})).then((function(e){e&&i(1)}))}),[]);var l=O((function(e){a.current=e.currentTarget.value}),[]),f=O((function(e){u.current=e.currentTarget.value}),[]),h=O((function(e){s.current=e.currentTarget.value}),[]),d=O((function(e){return new Promise((function(t,r){var o;return e.preventDefault(),a.current&&u.current?u.current!==s.current?t(n("Password doesn't match")):Promise.resolve(fetch("http://localhost/register",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},credentials:"include",body:new URLSearchParams({username:a.current,password:u.current})}).then((function(e){return e.json()}))).then((function(e){try{return(o=e).success||"Already signin in"===o.info?i(1):n(o.info),t()}catch(e){return r(e)}}),r):t(n("Username and Password can't be blank"))}))}),[]);return Object(c.h)("form",{id:"login",action:"http://localhost/register",method:"POST",onSubmit:d},Object(c.h)("h1",{class:"title"},"Signin"),Object(c.h)("label",{class:"label",for:"username"},"Username"),Object(c.h)("input",{class:"input username",name:"username",type:"text",placeholder:"Username",onInput:l}),Object(c.h)("label",{class:"label",for:"password"},"Password"),Object(c.h)("input",{class:"input password",name:"password",type:"password",placeholder:"Password",onChange:f}),Object(c.h)("label",{class:"label",for:"confirm-password"},"Confirm Password"),Object(c.h)("input",{class:"input confirm-password",name:"confirm-password",type:"password",placeholder:"Confirm Password",onChange:h}),t&&Object(c.h)("p",{class:"warning -hidden"},t),Object(c.h)("section",{class:"action"},Object(c.h)("button",{class:"login"},"Signup"),Object(c.h)(je,{href:"/signin"},Object(c.h)("a",{class:"link"},"Signin"))),o&&Object(c.h)(we,{href:"/"}))},pt=(n("QYsp"),function(){return Object(c.h)("main",{id:"not-found"},Object(c.h)("h1",{class:"title"},"404"),Object(c.h)("p",{class:"detail"},"The page you're looking found is not found"))}),vt=(n("qIS1"),function(){var e=ue().dispatch,t=v((function(e){return!0}),!1),n=t[0],r=t[1],o=ue("username","initial"),i=o.username,a=o.initial;return n?Object(c.h)(we,{href:"/"}):i||a?Object(c.h)("section",{id:"user"},Object(c.h)("h1",{class:"title"},"Welcome back ",i),Object(c.h)("aside",{class:"action-list"},Object(c.h)(je,{href:"/my-book"},Object(c.h)("a",{class:"action"},"My Book")),Object(c.h)("button",{class:"action",onClick:function(){return new Promise((function(t,n){return Promise.resolve(fetch("http://localhost/logout",{method:"GET",credentials:"include"})).then((function(o){try{return e("LOGOUT",""),r(1),t()}catch(e){return n(e)}}),n)}))}},"Logout"))):Object(c.h)(we,{href:"/signin"})});function bt(){return(bt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var _t=function(){var e=ue("username","initial"),t=e.username,n=e.initial,r=ct(["listBorrowed","{\n              listBorrowed {\n                data {\n                  id,\n                  title,\n                  author,\n                  price\n                }\n              }\n            }"],ut),o=r.data,i=r.error,a=p([]),u=a[0],s=a[1],l=function(e){return new Promise((function(t,n){return Promise.resolve(at("returnBooks",'mutation {\n              returnBooks(books: ["'+e+'"]) {\n                success\n              }\n            }')).then((function(r){try{return r.success?(s([].concat(u,[e])),t()):t(console.log("Something went wrong"))}catch(e){return n(e)}}),n)}))};return i?Object(c.h)("section",{id:"book-list",class:"-error"},Object(c.h)("h3",{class:"title"},"Failed to fetch"),Object(c.h)("p",{class:"detail"},"There is a problem requesting an list of books."),Object(c.h)("button",{class:"action",onClick:function(){return window.location.reload()}},"Retry")):!o||n?Object(c.h)("section",{id:"book-list"},Object(c.h)("h1",{class:"header"},"My Book"),Array(8).fill(null).map((function(e,t){return Object(c.h)(st,{key:t,preload:!0,hiddenPrice:!0})}))):t?o.length?Object(c.h)("section",{id:"book-list"},Object(c.h)("h1",{class:"header"},"My Book"),o.filter((function(e){return!u.includes(e.id)})).map((function(e){return Object(c.h)(st,bt({key:e.id},{book:e},{hiddenPrice:!0,onClick:l,action:"Return"}))}))):Object(c.h)("section",{id:"book-list",class:"-error"},Object(c.h)("h3",{class:"title"},"No Borrow"),Object(c.h)("p",{class:"detail"},"No book have been borrowed."),Object(c.h)(je,{href:"/"},Object(c.h)("button",{class:"action -compact"},"Borrow some book"))):Object(c.h)(we,{href:"/signin"})},mt=function(){var e,t,n,r,o,i,a;switch((t=(void 0===e?{}:e).base,r=p(Te(n=void 0===t?"":t)),o=r[0],i=r[1],a=m(o),b((function(){xe();var e=function(){var e=Te(n);a.current!==e&&i(a.current=e)},t=["popstate","pushState","replaceState"];return t.map((function(t){return addEventListener(t,e)})),e(),function(){return t.map((function(t){return removeEventListener(t,e)}))}}),[n]),[o,O((function(e,t){var r=(void 0===t?{}:t).replace;return history[void 0!==r&&r?"replaceState":"pushState"](0,0,n+e)}),[n])])[0]){case"/":return Object(c.h)(ft,null);case"/signin":return Object(c.h)(ht,null);case"/signup":return Object(c.h)(dt,null);case"/me":return Object(c.h)(vt,null);case"/my-book":return Object(c.h)(_t,null);default:return Object(c.h)(pt,null)}};n("9a+8"),t.default=function(){return b((function(){document.addEventListener("touchstart",(function(){return null}),{passive:!0})}),[]),Object(c.h)("main",null,Object(c.h)(ce.Provider,{value:H},Object(c.h)(Ee,null,Object(c.h)(Se,null,Object(c.h)(mt,null)))))}},"8Ubq":function(e,t,n){},"9a+8":function(e,t,n){},HWfQ:function(e,t,n){},HteQ:function(e,t){e.exports=require("preact")},OoM2:function(e,t,n){"use strict";var r=Array.isArray,o=Object.keys,i=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var c,a,u,s=r(t),l=r(n);if(s&&l){if((a=t.length)!=n.length)return!1;for(c=a;0!=c--;)if(!e(t[c],n[c]))return!1;return!0}if(s!=l)return!1;var f=t instanceof Date,h=n instanceof Date;if(f!=h)return!1;if(f&&h)return t.getTime()==n.getTime();var d=t instanceof RegExp,p=n instanceof RegExp;if(d!=p)return!1;if(d&&p)return t.toString()==n.toString();var v=o(t);if((a=v.length)!==o(n).length)return!1;for(c=a;0!=c--;)if(!i.call(n,v[c]))return!1;for(c=a;0!=c--;)if(!e(t[u=v[c]],n[u]))return!1;return!0}return t!=t&&n!=n}},QYsp:function(e,t,n){},hVea:function(e,t,n){},kJJ7:function(e,t,n){},qIS1:function(e,t,n){},tyAA:function(e,t,n){}});
//# sourceMappingURL=ssr-bundle.js.map